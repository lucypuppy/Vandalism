package de.vandalismdevelopment.vandalism.feature.impl.command.impl.exploit;

import com.mojang.brigadier.builder.LiteralArgumentBuilder;
import de.vandalismdevelopment.vandalism.feature.FeatureCategory;
import de.vandalismdevelopment.vandalism.feature.impl.command.Command;
import de.vandalismdevelopment.vandalism.feature.impl.command.arguments.ArmorSlotArgumentType;
import de.vandalismdevelopment.vandalism.util.PlayerUtil;
import net.minecraft.command.CommandSource;
import net.minecraft.screen.slot.SlotActionType;

public class ArmorCarryCommand extends Command {

    public ArmorCarryCommand() {
        super(
                "Armor Carry",
                "Allows you to put any item from your main hand into a armor slot.",
                FeatureCategory.EXPLOIT,
                false,
                "armorcarry"
        );
    }

    @Override
    public void build(final LiteralArgumentBuilder<CommandSource> builder) {
        builder.then(argument("armor-slot", ArmorSlotArgumentType.create()).executes(context -> {
            if (this.player().getMainHandStack().isEmpty()) {
                PlayerUtil.errorChatMessage("You need to hold an item in your main hand!");
            } else {
                final int button;
                switch (context.getArgument("armor-slot", ArmorSlotArgumentType.ArmorSlot.class)) {
                    case HELMET -> button = 39;
                    case CHESTPLATE -> button = 38;
                    case LEGGINGS -> button = 37;
                    case BOOTS -> button = 36;
                    default -> button = -1;
                }
                if (button != -1) {
                    this.interactionManager().clickSlot(
                            this.player().currentScreenHandler.syncId,
                            this.player().getInventory().selectedSlot + 36,
                            button,
                            SlotActionType.SWAP,
                            this.player()
                    );
                } else PlayerUtil.errorChatMessage("Invalid armor slot!");
            }
            return SINGLE_SUCCESS;
        }));
    }

}
