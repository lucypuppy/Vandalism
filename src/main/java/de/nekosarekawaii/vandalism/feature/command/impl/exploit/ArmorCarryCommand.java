package de.nekosarekawaii.vandalism.feature.command.impl.exploit;

import com.mojang.brigadier.builder.LiteralArgumentBuilder;
import de.nekosarekawaii.vandalism.feature.command.AbstractCommand;
import de.nekosarekawaii.vandalism.feature.command.arguments.ArmorSlotArgumentType;
import de.nekosarekawaii.vandalism.util.minecraft.ChatUtil;
import net.minecraft.command.CommandSource;
import net.minecraft.screen.slot.SlotActionType;

public class ArmorCarryCommand extends AbstractCommand {

    public ArmorCarryCommand() {
        super("Allows you to put any item from your main hand into a armor slot.", Category.EXPLOIT, "armorcarry");
    }

    @Override
    public void build(final LiteralArgumentBuilder<CommandSource> builder) {
        builder.then(argument("armor-slot", ArmorSlotArgumentType.create()).executes(context -> {
            if (this.mc.player.getMainHandStack().isEmpty()) {
                ChatUtil.errorChatMessage("You need to hold an item in your main hand!");
                return -1;
            }

            final int button;
            switch (ArmorSlotArgumentType.get(context)) {
                case HELMET -> button = 39;
                case CHESTPLATE -> button = 38;
                case LEGGINGS -> button = 37;
                case BOOTS -> button = 36;
                default -> button = -1;
            }

            if (button != -1) {
                this.mc.interactionManager.clickSlot(
                        this.mc.player.currentScreenHandler.syncId,
                        this.mc.player.getInventory().selectedSlot + 36,
                        button,
                        SlotActionType.SWAP,
                        this.mc.player
                );
            } else ChatUtil.errorChatMessage("Invalid armor slot!");

            return SINGLE_SUCCESS;
        }));
    }

}
